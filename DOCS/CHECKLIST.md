# ‚úÖ Socket.IO Server Checklist

## –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞

- [x] Socket.IO —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [x] Express —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω  
- [x] dotenv —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [x] `index.js` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è Socket.IO
- [x] `socketEmitter.js` —Å–æ–∑–¥–∞–Ω
- [x] HTTP API endpoints –≥–æ—Ç–æ–≤—ã
- [x] –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–∞–ø–∏—Å–∞–Ω—ã
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞
- [x] package.json –æ–±–Ω–æ–≤–ª–µ–Ω

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä

```bash
cd /Users/vlrebrov/Documents/dev/tsf/web/tsoftfactory/cz/socket-server
npm start
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
üöÄ Socket.IO Server Started
üì° HTTP Server:    http://0.0.0.0:3000
üîå Socket.IO:      http://0.0.0.0:3000
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

```bash
curl http://localhost:3000/health
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "status": "ok",
  "clients": 0,
  "rooms": 0,
  "uptime": 1.23
}
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –±—ç–∫–µ–Ω–¥–æ–º

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å socketEmitter (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

–í –≤–∞—à–µ–º main —Ñ–∞–π–ª–µ –±—ç–∫–µ–Ω–¥–∞:

```javascript
// –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
const socketEmitter = require('./path/to/socketEmitter');
const { io } = require('./path/to/socket-server/index');

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
socketEmitter.init(io);
```

–í API endpoints:

```javascript
const {emitNewComment} = require('socketEmitter');

// –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –≤ –ë–î
app.post('/api/game/:gameId/comment', async (req, res) => {
   const comment = await db.saveComment(...);
   const user = await db.getUser(userId);

   const fullComment = {
      id: comment.id,
      gameId: comment.gameId,
      userId: comment.userId,
      text: comment.text,
      createdAt: comment.createdAt,
      user: {
         id: user.id,
         username: user.username,
         avatar: user.avatar
      }
   };

   // ‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ Socket.IO
   emitNewComment(gameId, fullComment);

   res.json(fullComment);
});
```

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTP API

```javascript
// –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –≤ –ë–î
await fetch('http://localhost:3000/api/broadcast/game-comment/new', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    gameId: gameId,
    comment: fullComment
  })
});
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –¢–µ—Å—Ç 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å React Native –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
cd /Users/vlrebrov/Documents/dev/tsf/react/CaseZero
npm start
```

#### –¢–µ—Å—Ç 2: –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç –≤ –∏–≥—Ä–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –í–æ–π—Ç–∏ –≤ –∏–≥—Ä—É
3. –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç
4. –í –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
   ```
   [Socket.IO] Client connected: <socketId>
   [Socket.IO] <socketId> joined room: game_<gameId>
   ```

#### –¢–µ—Å—Ç 3: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ

1. –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç–µ
2. –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
3. Emit –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏)
4. –í—Å–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

#### –¢–µ—Å—Ç 4: –û—Ç–∫—Ä—ã—Ç—å –≤—Ç–æ—Ä–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤—Ç–æ—Ä–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
2. –ó–∞–π—Ç–∏ –≤ —Ç—É –∂–µ –∏–≥—Ä—É
3. –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç
4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø–µ—Ä–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
5. –û–Ω–æ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–∞ –≤—Ç–æ—Ä–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏!

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –∑–∞–Ω—è—Ç –ª–∏ –ø–æ—Ä—Ç
lsof -i :3000

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
kill -9 <PID>

# –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –≤ .env
echo "PORT=3001" > .env
```

### –ü—Ä–æ–±–ª–µ–º–∞: React Native –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `EXPO_PUBLIC_SOCKET_URL` –≤ React Native `.env`
2. –î–ª—è –ª–æ–∫–∞–ª–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IP –∫–æ–º–ø—å—é—Ç–µ—Ä–∞:
   ```bash
   ifconfig | grep "inet " | grep -v 127.0.0.1
   ```
3. –û–±–Ω–æ–≤–∏—Ç—å `.env` –≤ React Native:
   ```env
   EXPO_PUBLIC_SOCKET_URL=http://192.168.1.100:3000
   ```
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Expo: `npm start`

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ–±—ã—Ç–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ emit –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:
   - –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `[Emit] game_comment_new to game_123 - X clients`

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–ª–∏–µ–Ω—Ç –≤ –∫–æ–º–Ω–∞—Ç–µ:
   ```bash
   curl http://localhost:3000/api/room/game_123
   ```

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ emit

## –§–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è

- **README_SERVER.md** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞
- **API_INTEGRATION_EXAMPLE.js** - 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **socketEmitter.js** - –ì–æ—Ç–æ–≤—ã–π –º–æ–¥—É–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **index.js** - –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞

## –°—Ç–∞—Ç—É—Å

‚úÖ **–°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –Ω–∞ 100%**

‚è≥ **–ù—É–∂–Ω–æ: –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –±—ç–∫–µ–Ω–¥–æ–º API (5-15 –º–∏–Ω—É—Ç)**

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä: `npm start`
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health: `curl http://localhost:3000/health`
3. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å `emitNewComment()` –≤ API endpoints
4. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å React Native –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
5. üéâ –ù–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è real-time —á–∞—Ç–æ–º!

---

**–í—Å–µ –≥–æ—Ç–æ–≤–æ! –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å! üöÄ**
